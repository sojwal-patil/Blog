{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}{% endblock title %}</title>

  <!-- DaisyUI + Tailwind -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <!-- Main CSS -->
  <link rel="stylesheet" href="{% static 'main.css' %}">

  <!-- Font Awesome -->
  <script src="https://kit.fontawesome.com/96d552640e.js" crossorigin="anonymous"></script>
</head>

<body class="bg-gray-50 text-gray-900">

<!-- ================= NAVBAR ================= -->

<header class="sticky top-0 z-50 backdrop-blur-md bg-white/80 border-b border-gray-200">
  <div class="max-w-7xl mx-auto px-6">
    <div class="navbar px-0">

      <!-- Left: Logo -->
      <div class="navbar-start">
        <a href="{% url 'index' %}" class="text-xl font-semibold tracking-tight">
          <img src="{% static 'logo_blogify.png' %}"
               class="h-8 w-auto object-contain"
               alt="Blog Logo">
        </a>
      </div>

      <!-- Center: Desktop Navigation -->
      <div class="navbar-center hidden md:flex">
        <ul class="flex items-center gap-8 text-sm font-medium text-gray-700">
          <li><a href="{% url 'index' %}" class="hover:text-black transition">Home</a></li>
          <li><a href="{% url 'categories' %}" class="hover:text-black transition">Categories</a></li>
          <li><a href="{% url 'authors' %}" class="hover:text-black transition">Authors</a></li>
          <li><a href="#" class="hover:text-black transition">About</a></li>
        </ul>
      </div>

      <!-- Right: Actions -->
      <div class="navbar-end flex items-center gap-4">

        <!-- Search Button -->
        <button class="p-2 rounded-lg hover:bg-gray-100 transition"
                onclick="document.getElementById('search_modal').showModal()">
          <i class="fa-solid fa-magnifying-glass text-gray-700"></i>
        </button>

        <!-- Mobile Menu -->
        <div class="dropdown md:hidden">
          <button tabindex="0" class="p-2 rounded-lg hover:bg-gray-100">
            <i class="fa-solid fa-bars text-gray-700"></i>
          </button>
          <ul tabindex="0"
              class="menu dropdown-content mt-3 w-48 rounded-xl bg-white shadow-md border border-gray-100 p-2 right-0">
            <li><a>Home</a></li>
            <li><a>Categories</a></li>
            <li><a>Authors</a></li>
            <li><a>About</a></li>
          </ul>
        </div>

      </div>

    </div>
  </div>
</header>

<!-- ================= SEARCH MODAL ================= -->

<dialog id="search_modal" class="modal">
  <div class="modal-box rounded-2xl">

    <h3 class="font-semibold text-lg mb-4">Search</h3>

    <form id="search-form" class="flex gap-2">
      {% csrf_token %}
      <div class="flex-1">
        {{ search_form }}
      </div>
      <button type="submit" class="btn btn-neutral">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </form>

    <div id="results" class="mt-6 space-y-2 text-sm">
      {% for post in search_results %}
        <div>
          <a href="#" class="hover:underline">{{ post.title }}</a>
        </div>
      {% endfor %}
    </div>

  </div>

  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

<!-- ================= MAIN CONTENT ================= -->

<main class="min-h-screen">
  {% block index-main %}{% endblock index-main %}
</main>

<!-- ================= SEARCH SCRIPT ================= -->

<script>
const form = document.getElementById("search-form");

if (form) {
  form.addEventListener("submit", function(e) {
    e.preventDefault();

    const formData = new FormData(this);

    fetch("/", {
      method: "POST",
      body: formData,
      headers: {
        "X-CSRFToken": formData.get("csrfmiddlewaretoken")
      }
    })
    .then(res => res.text())
    .then(html => {
      document.getElementById("results").innerHTML = html;
    });
  });
}
</script>

</body>
</html>